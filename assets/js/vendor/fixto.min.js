var fixto=function($,window,document){var computedStyle=function(){var computedStyle={getAll:function(element){return document.defaultView.getComputedStyle(element)},get:function(element,name){return this.getAll(element)[name]},toFloat:function(value){return parseFloat(value,10)||0},getFloat:function(element,name){return this.toFloat(this.get(element,name))},_getAllCurrentStyle:function(element){return element.currentStyle}};if(document.documentElement.currentStyle){computedStyle.getAll=computedStyle._getAllCurrentStyle}return computedStyle}();var mimicNode=function(){function MimicNode(element){this.element=element;this.replacer=document.createElement("div");this.replacer.style.visibility="hidden";this.hide();element.parentNode.insertBefore(this.replacer,element)}MimicNode.prototype={replace:function(){var rst=this.replacer.style;var styles=computedStyle.getAll(this.element);rst.width=this._width();rst.height=this._height();rst.marginTop=styles.marginTop;rst.marginBottom=styles.marginBottom;rst.marginLeft=styles.marginLeft;rst.marginRight=styles.marginRight;rst.cssFloat=styles.cssFloat;rst.styleFloat=styles.styleFloat;rst.position=styles.position;rst.top=styles.top;rst.right=styles.right;rst.bottom=styles.bottom;rst.left=styles.left;rst.display=styles.display},hide:function(){this.replacer.style.display="none"},_width:function(){return this.element.getBoundingClientRect().width+"px"},_widthOffset:function(){return this.element.offsetWidth+"px"},_height:function(){return this.element.getBoundingClientRect().height+"px"},_heightOffset:function(){return this.element.offsetHeight+"px"},destroy:function(){$(this.replacer).remove();for(var prop in this){if(this.hasOwnProperty(prop)){this[prop]=null}}}};var bcr=document.documentElement.getBoundingClientRect();if(!bcr.width){MimicNode.prototype._width=MimicNode.prototype._widthOffset;MimicNode.prototype._height=MimicNode.prototype._heightOffset}return{MimicNode:MimicNode,computedStyle:computedStyle}}();function Prefix(){this._vendor=null}Prefix.prototype={_vendors:{webkit:{cssPrefix:"-webkit-",jsPrefix:"Webkit"},moz:{cssPrefix:"-moz-",jsPrefix:"Moz"},ms:{cssPrefix:"-ms-",jsPrefix:"ms"},opera:{cssPrefix:"-o-",jsPrefix:"O"}},_prefixJsProperty:function(vendor,prop){return vendor.jsPrefix+prop[0].toUpperCase()+prop.substr(1)},_prefixValue:function(vendor,value){return vendor.cssPrefix+value},_valueSupported:function(prop,value,dummy){try{dummy.style[prop]=value;return dummy.style[prop]===value}catch(er){return false}},propertySupported:function(prop){return document.documentElement.style[prop]!==undefined},getJsProperty:function(prop){if(this.propertySupported(prop)){return prop}if(this._vendor){return this._prefixJsProperty(this._vendor,prop)}var prefixed;for(var vendor in this._vendors){prefixed=this._prefixJsProperty(this._vendors[vendor],prop);if(this.propertySupported(prefixed)){this._vendor=this._vendors[vendor];return prefixed}}return null},getCssValue:function(prop,value){var dummy=document.createElement("div");var jsProperty=this.getJsProperty(prop);if(this._valueSupported(jsProperty,value,dummy)){return value}var prefixedValue;if(this._vendor){prefixedValue=this._prefixValue(this._vendor,value);if(this._valueSupported(jsProperty,prefixedValue,dummy)){return prefixedValue}}for(var vendor in this._vendors){prefixedValue=this._prefixValue(this._vendors[vendor],value);if(this._valueSupported(jsProperty,prefixedValue,dummy)){this._vendor=this._vendors[vendor];return prefixedValue}}return null}};var prefix=new Prefix;var transformJsProperty=prefix.getJsProperty("transform");var fixedPositioningContext;function checkFixedPositioningContextSupport(){var support=false;var parent=document.createElement("div");var child=document.createElement("div");parent.appendChild(child);parent.style[transformJsProperty]="translate(0)";parent.style.marginTop="10px";parent.style.visibility="hidden";child.style.position="fixed";child.style.top=0;document.body.appendChild(parent);var rect=child.getBoundingClientRect();if(rect.top>0){support=true}document.body.removeChild(parent);return support}var nativeStickyValue=prefix.getCssValue("position","sticky");var fixedPositionValue=prefix.getCssValue("position","fixed");var ie=navigator.appName==="Microsoft Internet Explorer";var ieversion;if(ie){ieversion=parseFloat(navigator.appVersion.split("MSIE")[1])}function FixTo(child,parent,options){this.child=child;this._$child=$(child);this.parent=parent;this.options={className:"fixto-fixed",top:0,mindViewport:false};this._setOptions(options)}FixTo.prototype={_mindtop:function(){var top=0;if(this._$mind){var el;var rect;var height;for(var i=0,l=this._$mind.length;i<l;i++){el=this._$mind[i];rect=el.getBoundingClientRect();if(rect.height){top+=rect.height}else{var styles=computedStyle.getAll(el);top+=el.offsetHeight+computedStyle.toFloat(styles.marginTop)+computedStyle.toFloat(styles.marginBottom)}}}return top},stop:function(){this._stop();this._running=false},start:function(){if(!this._running){this._start();this._running=true}},destroy:function(){this.stop();this._destroy();this._$child.removeData("fixto-instance");for(var prop in this){if(this.hasOwnProperty(prop)){this[prop]=null}}},_setOptions:function(options){$.extend(this.options,options);if(this.options.mind){this._$mind=$(this.options.mind)}if(this.options.zIndex){this.child.style.zIndex=this.options.zIndex}},setOptions:function(options){this._setOptions(options);this.refresh()},_stop:function(){},_start:function(){},_destroy:function(){},refresh:function(){}};function FixToContainer(child,parent,options){FixTo.call(this,child,parent,options);this._replacer=new mimicNode.MimicNode(child);this._ghostNode=this._replacer.replacer;this._saveStyles();this._saveViewportHeight();this._proxied_onscroll=this._bind(this._onscroll,this);this._proxied_onresize=this._bind(this._onresize,this);this.start()}FixToContainer.prototype=new FixTo;$.extend(FixToContainer.prototype,{_bind:function(fn,context){return function(){return fn.call(context)}},_toresize:ieversion===8?document.documentElement:window,_onscroll:function _onscroll(){this._scrollTop=document.documentElement.scrollTop||document.body.scrollTop;this._parentBottom=this.parent.offsetHeight+this._fullOffset("offsetTop",this.parent);if(this.options.mindBottomPadding!==false){this._parentBottom-=computedStyle.getFloat(this.parent,"paddingBottom")}if(!this.fixed&&this._shouldFix()){this._fix();this._adjust()}else{if(this._scrollTop>this._parentBottom||this._scrollTop<this._fullOffset("offsetTop",this._ghostNode)-this.options.top-this._mindtop()){this._unfix();return}this._adjust()}},_shouldFix:function(){if(this._scrollTop<this._parentBottom&&this._scrollTop>this._fullOffset("offsetTop",this.child)-this.options.top-this._mindtop()){if(this.options.mindViewport&&!this._isViewportAvailable()){return false}return true}},_isViewportAvailable:function(){var childStyles=computedStyle.getAll(this.child);return this._viewportHeight>this.child.offsetHeight+computedStyle.toFloat(childStyles.marginTop)+computedStyle.toFloat(childStyles.marginBottom)},_adjust:function _adjust(){var top=0;var mindTop=this._mindtop();var diff=0;var childStyles=computedStyle.getAll(this.child);var context=null;if(fixedPositioningContext){context=this._getContext();if(context){top=Math.abs(context.getBoundingClientRect().top)}}diff=this._parentBottom-this._scrollTop-(this.child.offsetHeight+computedStyle.toFloat(childStyles.marginBottom)+mindTop+this.options.top);if(diff>0){diff=0}this.child.style.top=diff+mindTop+top+this.options.top-computedStyle.toFloat(childStyles.marginTop)+"px"},_fullOffset:function _fullOffset(offsetName,elm,context){var offset=elm[offsetName];var offsetParent=elm.offsetParent;while(offsetParent!==null&&offsetParent!==context){offset=offset+offsetParent[offsetName];offsetParent=offsetParent.offsetParent}return offset},_getContext:function(){var parent;var element=this.child;var context=null;var styles;while(!context){parent=element.parentNode;if(parent===document.documentElement){return null}styles=computedStyle.getAll(parent);if(styles[transformJsProperty]!=="none"){context=parent;break}element=parent}return context},_fix:function _fix(){var child=this.child;var childStyle=child.style;var childStyles=computedStyle.getAll(child);var left=child.getBoundingClientRect().left;var width=childStyles.width;this._saveStyles();if(document.documentElement.currentStyle){width=child.offsetWidth-(computedStyle.toFloat(childStyles.paddingLeft)+computedStyle.toFloat(childStyles.paddingRight)+computedStyle.toFloat(childStyles.borderLeftWidth)+computedStyle.toFloat(childStyles.borderRightWidth))+"px"}if(fixedPositioningContext){var context=this._getContext();if(context){left=child.getBoundingClientRect().left-context.getBoundingClientRect().left}}this._replacer.replace();childStyle.left=left-computedStyle.toFloat(childStyles.marginLeft)+"px";childStyle.width=width;childStyle.position="fixed";childStyle.top=this._mindtop()+this.options.top-computedStyle.toFloat(childStyles.marginTop)+"px";this._$child.addClass(this.options.className);this.fixed=true},_unfix:function _unfix(){var childStyle=this.child.style;this._replacer.hide();childStyle.position=this._childOriginalPosition;childStyle.top=this._childOriginalTop;childStyle.width=this._childOriginalWidth;childStyle.left=this._childOriginalLeft;this._$child.removeClass(this.options.className);this.fixed=false},_saveStyles:function(){var childStyle=this.child.style;this._childOriginalPosition=childStyle.position;this._childOriginalTop=childStyle.top;this._childOriginalWidth=childStyle.width;this._childOriginalLeft=childStyle.left},_onresize:function(){this.refresh()},_saveViewportHeight:function(){this._viewportHeight=window.innerHeight||document.documentElement.clientHeight},_stop:function(){this._unfix();$(window).unbind("scroll",this._proxied_onscroll);$(this._toresize).unbind("resize",this._proxied_onresize)},_start:function(){this._onscroll();$(window).bind("scroll",this._proxied_onscroll);$(this._toresize).bind("resize",this._proxied_onresize)},_destroy:function(){this._replacer.destroy()},refresh:function(){this._saveViewportHeight();this._unfix();this._onscroll()}});function NativeSticky(child,parent,options){FixTo.call(this,child,parent,options);this.start()}NativeSticky.prototype=new FixTo;$.extend(NativeSticky.prototype,{_start:function(){var childStyles=computedStyle.getAll(this.child);this._childOriginalPosition=childStyles.position;this._childOriginalTop=childStyles.top;this.child.style.position=nativeStickyValue;this.refresh()},_stop:function(){this.child.style.position=this._childOriginalPosition;this.child.style.top=this._childOriginalTop},refresh:function(){this.child.style.top=this._mindtop()+this.options.top+"px"}});var fixTo=function fixTo(childElement,parentElement,options){if(nativeStickyValue&&!options||nativeStickyValue&&options&&options.useNativeSticky!==false){return new NativeSticky(childElement,parentElement,options)}else if(fixedPositionValue){if(fixedPositioningContext===undefined){fixedPositioningContext=checkFixedPositioningContextSupport()}return new FixToContainer(childElement,parentElement,options)}else{return"Neither fixed nor sticky positioning supported"}};if(ieversion<8){fixTo=function(){return"not supported"}}$.fn.fixTo=function(targetSelector,options){var $targets=$(targetSelector);var i=0;return this.each(function(){var instance=$(this).data("fixto-instance");if(!instance){$(this).data("fixto-instance",fixTo(this,$targets[i],options))}else{var method=targetSelector;instance[method].call(instance,options)}i++})};return{FixToContainer:FixToContainer,fixTo:fixTo,computedStyle:computedStyle,mimicNode:mimicNode}}(window.jQuery,window,document);